#!/bin/bash

set -e

#normalize-bookmarks

if [ -z "$*" ]; then
  echo "#>>> cvs updating META ..."
  cd ~/.cvs/config/META
  cvsuhq
  if [ etc/config.map.template -nt etc/config.map ]; then
      echo "etc/config.map.template newer then /etc/config.map; please merge ..."
      echo "Press enter to edit ..."
      read foo
      ${EDITOR:-vi} etc/config.map{,.template}
  fi

  echo "#>>> cvs updating config ..."
  cd ~/.cvs/config
  cvsuhq

  echo "#>>> cvs updating personal ..."
  cd ~/.cvs/personal
  cvsuhq

  echo "#>>> cfgctl ..."
  cfgctl
else
  dirs=
  for pkg in "$@"; do
    cd ~/.cfg/$pkg
    echo "#>>> cvs updating $pkg ..."
    cvsuhq
    echo "#>>> cfgctl $pkg ..."
    cfgctl "$pkg"
  done
fi

